<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Menú Principal · Solicitud de informes</title>

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root{
      --minsa-primary:#26abd3; --minsa-primary-dark:#1a7a99; --minsa-primary-light:#D4E9F0;
      --white:#fff; --muted:#6b7b80; --grid:rgba(20,40,50,0.04);
      --font-family:"Inter", "Segoe UI", Roboto, system-ui, Arial, sans-serif;
      --radius-global:10px; --soft-shadow:0 8px 22px rgba(10,30,40,0.04);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:var(--font-family);background:linear-gradient(180deg,#f7fbfc,#fff);color:var(--minsa-primary-dark)}
    .topbar{height:64px;display:flex;align-items:center;padding:0 16px;background:linear-gradient(90deg,var(--minsa-primary),#3dbde6);color:#fff;box-shadow:0 2px 6px rgba(38,171,211,.12)}
    .brand{font-weight:700}
    .container{display:flex;gap:18px;padding:16px;min-height:calc(100vh - 64px)}
    .left{width:360px}
    .content{flex:1;display:flex;flex-direction:column;gap:16px}
    .panel{background:linear-gradient(180deg, rgba(212,233,240,.95), rgba(212,233,240,.85));padding:14px;border-radius:var(--radius-global);box-shadow:var(--soft-shadow)}
    .menu-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    .menu-btn{display:flex;align-items:center;justify-content:center;height:56px;background:rgba(255,255,255,.95);border-radius:10px;cursor:pointer;border:1px solid rgba(0,0,0,.04);font-weight:600;transition:all .12s}
    .menu-btn:hover{transform:translateY(-4px);box-shadow:0 12px 30px rgba(10,30,40,.06)}
    .menu-btn.primary{background:linear-gradient(180deg,var(--minsa-primary), #1aa0c6);color:#fff}
    .menu-btn.active{outline:3px solid rgba(38,171,211,.12)}
    .viewer{height:720px;border-radius:var(--radius-global);overflow:hidden;border:1px solid rgba(0,0,0,.04);background:#fff;box-shadow:var(--soft-shadow)}
    .viewer iframe{width:100%;height:100%;border:0}
    .muted{color:var(--muted);font-size:13px}
    .controls{display:flex;gap:10px;align-items:center}
    @media (max-width:980px){.container{flex-direction:column}.menu-grid{grid-template-columns:repeat(3,1fr)}.viewer{height:520px}}
  </style>
</head>
<body>
  <div class="topbar">
    <div class="brand">MENÚ PRINCIPAL</div>
    <div style="flex:1"></div>
    <div style="background:#fff;color:var(--minsa-primary-dark);padding:6px 10px;border-radius:999px;font-weight:700">Solicitud de información - Noviembre 2025</div>
  </div>

  <div class="container">
    <aside class="left">
      <div class="panel">
        <h4 style="margin:0 0 10px 0">VIH - TAR</h4>
        <div id="menuGrid" class="menu-grid"></div>
        <div class="muted" style="margin-top:12px">Sistema de información - DPVIH</div>
      </div>
    </aside>

    <main class="content">
      <section class="panel viewer" id="viewer">
        <iframe id="dashboardFrame" src="" title="Vista del dashboard"></iframe>
      </section>

      <section class="panel" style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <strong id="currentLabel">Ningún informe cargado</strong>
          <div class="muted" style="margin-top:6px" id="currentPath"></div>
        </div>
        <div class="controls">
          <button id="openInNew" class="menu-btn" style="height:40px">Abrir en nueva pestaña</button>
        </div>
      </section>
    </main>
  </div>

  <script>
    /* ===========================
       Lista de páginas (añade aquí)
       - id: identificador único (sin espacios)
       - label: texto del botón
       - file: ruta relativa al archivo HTML (evita espacios en nombres de archivo)
       - primary (opt): true para estilo destacado
       - newTab (opt): true para abrir por defecto en nueva pestaña
       - default (opt): true para cargar al abrir index
       ============================ */
    const PAGES = [
      { id: 'analisis_esquemas', label: 'Análisis de esquemas', file: 'analisis_esquemas.html', primary: true, default: true },
      { id: 'coinfeccion_tb_vih', label: 'Información de coinfección TB/VIH', file: 'informacion_coinfeccion_tb_vih.html' },
      { id: 'solicitud_abandonos', label: 'Solicitud de abandonos', file: 'solicitud_abandonos.html' },
      { id: '', label: '', file: '' },
      { id: '', label: '', file: '' },
      { id: '', label: '', file: '' },
      { id: '', label: '', file: '' }
    ];

    const menuGrid = document.getElementById('menuGrid');
    const iframe = document.getElementById('dashboardFrame');
    const openInNew = document.getElementById('openInNew');
    const currentLabel = document.getElementById('currentLabel');
    const currentPath = document.getElementById('currentPath');

    let currentPageId = null;

    // Genera botones a partir del array PAGES
    function buildMenu(){
      menuGrid.innerHTML = '';
      PAGES.forEach(p => {
        const btn = document.createElement('div');
        btn.className = 'menu-btn' + (p.primary ? ' primary' : '');
        btn.textContent = p.label;
        btn.dataset.file = p.file;
        btn.dataset.id = p.id;
        if(p.newTab) btn.dataset.newtab = '1';
        btn.addEventListener('click', () => loadPage(p.id));
        menuGrid.appendChild(btn);
      });
    }

    // Carga la página en el iframe o en nueva pestaña si newTab === true
    function loadPage(id){
      const page = PAGES.find(x => x.id === id);
      if(!page) return;
      // actualizar UI active
      document.querySelectorAll('.menu-btn').forEach(b => b.classList.toggle('active', b.dataset.id === id));
      currentPageId = id;
      currentLabel.textContent = page.label;
      currentPath.textContent = page.file;
      if(page.newTab){
        window.open(page.file, '_blank');
      } else {
        iframe.src = page.file;
      }
    }

    // botón "Abrir en nueva pestaña" abre la página seleccionada o la por defecto
    openInNew.addEventListener('click', () => {
      const page = PAGES.find(x => x.id === currentPageId) || PAGES.find(x => x.default) || PAGES[0];
      if(page) window.open(page.file, '_blank');
    });

    // Inicialización
    buildMenu();
    // Cargar la default (si existe)
    const defaultPage = PAGES.find(x => x.default) || PAGES[0];
    if(defaultPage) loadPage(defaultPage.id);

    /* ===========================
       Consejos rápidos:
       - Nombres de archivo: evita espacios y caracteres especiales (usar guiones o guion_bajo).
       - Añadir página: insertar nuevo objeto en PAGES con id único.
       - Si pones default:true en una página, se cargará al abrir index.
       - Si tus dashboards están en subcarpetas, especifica file:'dashboards/nombre.html'
       ============================ */
  </script>
</body>
</html>
